<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device‑width, initial‑scale=1.0" />
  <title>TBN Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --color-primary: #0e7490;         /* deep ocean teal */
      --color-accent: #06b6d4;          /* bright cyan highlight */
      --color-bg-light: #ecfeff;        /* very light cyan background */
      --color-bg-dark: #0f172a;         /* deep ocean navy */
      --color-card-light: #ffffff;
      --color-card-dark: #1e293b;
      --color-text-light: #0f172a;
      --color-text-dark: #e0f2fe;
    }
    [data-theme="dark"] {
      --bg: var(--color-bg-dark);
      --card: var(--color-card-dark);
      --text: var(--color-text-dark);
    }
    [data-theme="light"] {
      --bg: var(--color-bg-light);
      --card: var(--color-card-light);
      --text: var(--color-text-light);
    }
    body {
      background-color: var(--bg);
      color: var(--text);
      transition: background-color .3s, color .3s;
    }
    .card {
      background-color: var(--card);
      transition: background-color .3s;
    }
    .tab-btn.active {
      background-color: var(--color-accent);
      color: white;
    }
    .tab-btn {
      transition: background-color .3s, color .3s;
    }
    .btn-primary {
      background-color: var(--color-primary);
      color: white;
      transition: background-color .3s;
    }
    .btn-primary:hover {
      background-color: var(--color-accent);
    }
    .btn-toggle {
      background: none;
      border: 2px solid var(--color-primary);
      color: var(--color-primary);
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      cursor: pointer;
      transition: background-color .3s, color .3s, border-color .3s;
    }
    .btn-toggle:hover {
      background-color: var(--color-primary);
      color: white;
    }
  </style>
</head>
<body data-theme="light" class="min-h-screen font-sans flex flex-col">
  <div class="container mx-auto p-6 flex-grow">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-4xl font-bold" style="color: var(--color-primary);">TBN Calculator</h1>
      <button id="themeToggle" class="btn-toggle">Toggle Dark Mode</button>
    </div>

    <!-- Tabs -->
    <div class="flex flex-wrap justify-center space-x-2 mb-4">
      <button class="tab-btn px-5 py-2 rounded-lg active" data-tab="cargo">Cargo Intake</button>
      <button class="tab-btn px-5 py-2 rounded-lg" data-tab="voyage">Mini Voyage</button>
      <button class="tab-btn px-5 py-2 rounded-lg" data-tab="ballast">Ballast</button>
      <button class="tab-btn px-5 py-2 rounded-lg" data-tab="openbook">Open Book</button>
    </div>

    <!-- Tab Panels -->
    <div id="cargo" class="tab-content">
      <div class="card p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-semibold mb-4" style="color: var(--color-primary);">Cargo Intake Calculator</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <label class="block">Deadweight</label>
            <input type="number" id="deadweight" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Draft</label>
            <input type="number" id="draft" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">TPC</label>
            <input type="number" id="tpc" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Grain Capacity</label>
            <input type="number" id="grainCapacity" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">SF</label>
            <input type="number" id="sf" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Draft Restriction</label>
            <input type="number" id="draftRestriction" class="w-full p-3 border rounded-md" step="any"/>
          </div>
          <div class="space-y-4">
            <label class="block">Water Density</label>
            <input type="number" id="waterDensity" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Vessel Constant</label>
            <input type="number" id="vslConstant" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Qty</label>
            <input type="number" id="qty" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Tolerance (%)</label>
            <input type="number" id="tolerance" class="w-full p-3 border rounded-md" step="any"/>
            <label class="block">Tropical</label>
            <select id="tropical" class="w-full p-3 border rounded-md">
              <option value="Yes">Yes</option>
              <option value="No">No</option>
            </select>
            <button onclick="calculateCargo()" class="btn-primary w-full py-3 rounded-md mt-4">Calculate</button>
          </div>
        </div>
        <div class="mt-6 p-4 rounded-md" style="background-color: var(--bg);">
          <h3 class="font-bold mb-2">Result</h3>
          <div id="output" class="text-lg font-medium"></div>
        </div>
      </div>
    </div>

    <div id="voyage" class="tab-content hidden">
      <div class="card p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-semibold mb-4" style="color: var(--color-primary);">Mini Voyage Calculator</h2>
        <form class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md space-y-4">
            <h3 class="font-bold mb-2">Cargo Details</h3>
            <label>Cargo Qty:</label>
            <input type="number" id="cargoQty" class="w-full p-2 border rounded-md"/>
            <label>Load Rate:</label>
            <input type="number" id="loadRate" class="w-full p-2 border rounded-md"/>
            <label>Discharge Rate:</label>
            <input type="number" id="dischargeRate" class="w-full p-2 border rounded-md"/>
            <label>Extra Days:</label>
            <input type="number" id="extraDays" class="w-full p-2 border rounded-md"/>
            <label>PDA:</label>
            <input type="number" id="pda" class="w-full p-2 border rounded-md"/>
            <label>Other Expenses:</label>
            <input type="number" id="otherExpenses" class="w-full p-2 border rounded-md"/>
            <label>Bunker Price (VLSFO):</label>
            <input type="number" id="vlsfoRate" class="w-full p-2 border rounded-md"/>
          </div>
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md space-y-4">
            <h3 class="font-bold mb-2">Voyage Details</h3>
            <label>Laden Days:</label>
            <input type="number" id="ladenDays" class="w-full p-2 border rounded-md"/>
            <label>Ballast Days:</label>
            <input type="number" id="ballastDays" class="w-full p-2 border rounded-md"/>
            <label>Sea Consumption:</label>
            <input type="number" id="seaConsumption" class="w-full p-2 border rounded-md"/>
            <label>Working Consumption:</label>
            <input type="number" id="workingConsumption" class="w-full p-2 border rounded-md"/>
            <label>Idle Consumption:</label>
            <input type="number" id="idleConsumption" class="w-full p-2 border rounded-md"/>
            <label>Hire (per day):</label>
            <input type="number" id="hire" class="w-full p-2 border rounded-md"/>
            <label>ADDCOM (e.g. 0.0375):</label>
            <input type="number" id="addcom" class="w-full p-2 border rounded-md"/>
          </div>
        </form>
        <div class="text-center mt-4">
          <button type="button" onclick="calculateVoyage()" class="btn-primary px-6 py-3 rounded-md">Calculate</button>
        </div>
        <div id="outputSection" class="mt-6 p-4 rounded-md" style="background-color: var(--bg); display: none;">
          <h3 class="font-bold mb-2">Calculation Results</h3>
          <p><strong>Total Duration:</strong> <span id="totalDuration"></span> days</p>
          <p><strong>Total Consumption:</strong> <span id="totalConsumption"></span></p>
          <p><strong>Total Bunker Cost:</strong> <span id="totalBunkerCost"></span></p>
          <p><strong>Total Expenses:</strong> <span id="totalExpenses"></span></p>
          <p><strong>Freight:</strong> <span id="freight"></span></p>
        </div>
      </div>
    </div>

    <div id="ballast" class="tab-content hidden">
      <div class="card p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-semibold mb-4" style="color: var(--color-primary);">Ballast Calculator</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="space-y-4">
            <label>Ballast Days:</label>
            <input type="number" id="ballastDaysBallast" class="w-full p-2 border rounded-md" value="0"/>
            <label>Total Voyage Days:</label>
            <input type="number" id="voyageDays" class="w-full p-2 border rounded-md" value="0"/>
            <label>Bunker Price:</label>
            <input type="number" id="bunkerPrice" class="w-full p-2 border rounded-md" value="0"/>
          </div>
          <div class="space-y-4">
            <label>Vessel Ballast Consumption:</label>
            <input type="number" id="consumptionBallast" class="w-full p-2 border rounded-md" value="0"/>
            <label>Hire Basis APS Position:</label>
            <input type="number" id="hireBssAps" class="w-full p-2 border rounded-md" value="0"/>
            <label>Ballast Bonus:</label>
            <input type="number" id="ballastBonus" class="w-full p-2 border rounded-md" value="0"/>
          </div>
        </div>
        <div class="mt-6 p-4 rounded-md" style="background-color: var(--bg);">
          <h3 class="font-bold mb-2">Result</h3>
          <div id="grossDOPHire" class="text-lg font-semibold" style="color: var(--color-accent);"></div>
        </div>
      </div>
    </div>

    <div id="openbook" class="tab-content hidden">
      <div class="card p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-semibold mb-4" style="color: var(--color-primary);">Open Book Calculator</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md space-y-4">
            <h3 class="font-bold mb-2">Cargo Details</h3>
            <label>Base Freight:</label>
            <input type="number" id="baseFreight" class="w-full p-2 border rounded-md"/>
            <label>Quantity:</label>
            <input type="number" id="quantity" class="w-full p-2 border rounded-md"/>
            <label>Initial Rate:</label>
            <input type="number" id="initialRate" class="w-full p-2 border rounded-md"/>
            <label>Revised Rate:</label>
            <input type="number" id="revisedRate" class="w-full p-2 border rounded-md"/>
            <label>Additional Days:</label>
            <input type="number" id="additionalDays" class="w-full p-2 border rounded-md"/>
            <label>Extra Miles:</label>
            <input type="number" id="extraMiles" class="w-full p-2 border rounded-md"/>
            <label>Extra Expenses:</label>
            <input type="number" id="extraExpenses" class="w-full p-2 border rounded-md"/>
          </div>
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md space-y-4">
            <h3 class="font-bold mb-2">Vessel Details</h3>
            <label>Ballast Speed:</label>
            <input type="number" id="ballastSpeed" class="w-full p-2 border rounded-md"/>
            <label>Laden Speed:</label>
            <input type="number" id="ladenSpeed" class="w-full p-2 border rounded-md"/>
            <label>Ballast VLSFO:</label>
            <input type="number" id="ballastVLSFO" class="w-full p-2 border rounded-md"/>
            <label>Laden VLSFO:</label>
            <input type="number" id="ladenVLSFO" class="w-full p-2 border rounded-md"/>
            <label>Sea LSMGO:</label>
            <input type="number" id="seaLSMGO" class="w-full p-2 border rounded-md"/>
            <label>Idle VLSFO:</label>
            <input type="number" id="idleVLSFO" class="w-full p-2 border rounded-md"/>
            <label>Working VLSFO:</label>
            <input type="number" id="workingVLSFO" class="w-full p-2 border rounded-md"/>
            <label>Port LSMGO:</label>
            <input type="number" id="portLSMGO" class="w-full p-2 border rounded-md"/>
          </div>
          <div class="bg-gray-50 dark:bg-gray-800 p-4 rounded-md space-y-4">
            <h3 class="font-bold mb-2">Fuel & Hire</h3>
            <label>VLSFO Cost:</label>
            <input type="number" id="vlsfoCost" class="w-full p-2 border rounded-md"/>
            <label>LSMGO Cost:</label>
            <input type="number" id="lsmgoCost" class="w-full p-2 border rounded-md"/>
            <label>Vessel Hire:</label>
            <input type="number" id="vesselHire" class="w-full p-2 border rounded-md"/>
            <label>Addcom %:</label>
            <input type="number" id="addcomOpen" class="w-full p-2 border rounded-md"/>
          </div>
        </div>
        <div class="mt‑6 p‑4 rounded‑md" style="background‑color:var(--bg);">
          <h3 class="font‑bold mb‑2">Results</h3>
          <div class="grid grid‑cols‑1 md:grid‑cols‑2 gap‑4">
            <div>
              <p>Extra Sailing: <span id="extraSailing">0</span></p>
              <p>Extra Port Days: <span id="extraPortDays">0</span></p>
              <p>Total Days: <span id="totalDays">0</span></p>
              <p>VLSFO Sea: <span id="vlsfoSea">0</span></p>
              <p>VLSFO Port: <span id="vlsfoPort">0</span></p>
              <p>LSMGO Sea: <span id="lsmgoSea">0</span></p>
            </div>
            <div>
              <p>LSMGO Port: <span id="lsmgoPort">0</span></p>
              <p>VLSFO Cost: <span id="costVLSFO">0</span></p>
              <p>LSMGO Cost: <span id="costLSMGO">0</span></p>
              <p>Extra Cost: <span id="extraCost">0</span></p>
              <p>Additional Freight: <span id="additionalFreight">0</span></p>
              <p>New Freight: <span id="newFreight">0</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <footer class="text-center py‑4 text‑sm" style="color: var(--text);">&copy; 2025 Multi‑Calculator App</footer>

  <!-- JavaScript logic -->
  <script>
    // Theme toggle logic
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      const current = document.body.getAttribute('data-theme');
      const next = current === 'light' ? 'dark' : 'light';
      document.body.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });
    window.addEventListener('DOMContentLoaded', () => {
      const saved = localStorage.getItem('theme') || 'light';
      document.body.setAttribute('data-theme', saved);
    });

    // Tab navigation logic
    const tabButtons = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-content');
    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const target = button.getAttribute('data-tab');
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabPanels.forEach(panel => panel.classList.add('hidden'));
        button.classList.add('active');
        document.getElementById(target).classList.remove('hidden');
      });
    });
    // Initialize first tab
    tabButtons[0].classList.add('active');
    tabPanels[0].classList.remove('hidden');

    // Calculator 1 logic: Cargo Intake
    function calculateCargo() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      const dwt = val('deadweight'), draft = val('draft'), tpc = val('tpc'),
            grainCap = val('grainCapacity'), sf = val('sf'), draftRes = val('draftRestriction'),
            waterDen = val('waterDensity'), vslConst = val('vslConstant'),
            qty = val('qty'), tol = val('tolerance')/100, tropical = document.getElementById('tropical').value;
      const qtyAsPerGrain = grainCap / sf;
      const draftAsPerDensity = draftRes * waterDen / 1.025;
      const draftChange = draft < draftAsPerDensity ? 0 : draft - draftAsPerDensity;
      const dwtChange = draftChange * tpc * 100;
      const restrictedDwt = dwt - dwtChange;
      const intakeQty = restrictedDwt - vslConst;
      const tropicalDraft = draft * 49 / 48;
      const tropicalDwt = (tropicalDraft - draft) * tpc * 100 + dwt;
      const tropicalIntake = tropicalDwt - vslConst;
      let others;
      if (draftChange === 0) {
        others = (draftRes > tropicalDraft) ? tropicalIntake : ((draftRes - draft) * tpc * 100 + dwt - vslConst);
      } else {
        others = intakeQty;
      }
      const tropicalOrSummer = tropical === 'Yes' ? others : intakeQty;
      const basedOnInput = (qty * (1 + tol)) < tropicalOrSummer ? qty * (1 + tol) : tropicalOrSummer;
      const actualIntakeQty = basedOnInput < qtyAsPerGrain ? basedOnInput : qtyAsPerGrain;
      document.getElementById('output').innerHTML = `<strong>Actual Intake Quantity:</strong> ${actualIntakeQty.toFixed(2)} MT`;
    }

    // Calculator 2 logic: Mini Voyage
    function calculateVoyage() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      const cargoQty = val("cargoQty"), loadRate = val("loadRate"), dischargeRate = val("dischargeRate"),
            extraDays = val("extraDays"), pda = val("pda"), otherExpenses = val("otherExpenses"),
            vlsfoRate = val("vlsfoRate"), ladenDays = val("ladenDays"), ballastDays = val("ballastDays"),
            seaConsumption = val("seaConsumption"), workingConsumption = val("workingConsumption"),
            idleConsumption = val("idleConsumption"), hire = val("hire"), addcom = val("addcom");
      const loadingTime = loadRate > 0 ? cargoQty / loadRate : 0;
      const dischargingTime = dischargeRate > 0 ? cargoQty / dischargeRate : 0;
      const totalDuration = ladenDays + ballastDays + extraDays + loadingTime + dischargingTime;
      const totalConsumption = (ladenDays * seaConsumption) + (ballastDays * seaConsumption) + (loadingTime * workingConsumption) + (dischargingTime * workingConsumption) + (extraDays * idleConsumption);
      const totalBunkerCost = totalConsumption * vlsfoRate;
      const totalExpenses = (totalDuration * hire * 0.9625) + totalBunkerCost + pda + otherExpenses;
      const freight = cargoQty > 0 ? (totalExpenses / cargoQty) * (1 + addcom) : 0;
      document.getElementById("totalDuration").textContent = totalDuration.toFixed(2);
      document.getElementById("totalConsumption").textContent = totalConsumption.toFixed(2);
      document.getElementById("totalBunkerCost").textContent = totalBunkerCost.toFixed(2);
      document.getElementById("totalExpenses").textContent = totalExpenses.toFixed(2);
      document.getElementById("freight").textContent = freight.toFixed(2);
      document.getElementById("outputSection").style.display = 'block';
    }

    // Calculator 3 logic: Ballast
    function calculateGrossDOPHire() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      const ballastDays = val("ballastDaysBallast"), voyageDays = val("voyageDays"),
            bunkerPrice = val("bunkerPrice"), consumptionBallast = val("consumptionBallast"),
            hireBssAps = val("hireBssAps"), ballastBonus = val("ballastBonus");
      if (voyageDays === 0) {
        document.getElementById("grossDOPHire").innerText = "0.00";
        return;
      }
      const grossDOPHire = (((voyageDays - ballastDays) * hireBssAps * 0.95) - (bunkerPrice * consumptionBallast * ballastDays) + ballastBonus) / voyageDays / 0.95;
      document.getElementById("grossDOPHire").innerText = grossDOPHire.toFixed(2);
    }
    document.querySelectorAll('#ballast input').forEach(input => { input.addEventListener('input', calculateGrossDOPHire); });
    window.addEventListener('load', calculateGrossDOPHire);

    // Calculator 4 logic: Open Book
    function calcOpenBook() {
      const val = id => parseFloat(document.getElementById(id).value) || 0;
      const baseFreight = val("baseFreight"), quantity = val("quantity"), initialRate = val("initialRate"),
            revisedRate = val("revisedRate"), additionalDays = val("additionalDays"), extraMiles = val("extraMiles"),
            extraExpenses = val("extraExpenses"), ballastSpeed = val("ballastSpeed"), ladenSpeed = val("ladenSpeed"),
            ballastVLSFO = val("ballastVLSFO"), ladenVLSFO = val("ladenVLSFO"), seaLSMGO = val("seaLSMGO"),
            idleVLSFO = val("idleVLSFO"), workingVLSFO = val("workingVLSFO"), portLSMGO = val("portLSMGO"),
            vlsfoCost = val("vlsfoCost"), lsmgoCost = val("lsmgoCost"), vesselHire = val("vesselHire"), addcom = val("addcomOpen");
      const extraSailing = ladenSpeed > 0 ? extraMiles / (24 * ladenSpeed) : 0;
      const extraPortDays = initialRate > 0 ? ((quantity / revisedRate) - (quantity / initialRate)) + additionalDays : additionalDays;
      const totalDays = extraSailing + extraPortDays;
      const vlsfoSea = extraSailing * ladenVLSFO;
      const vlsfoPort = ((extraPortDays - additionalDays) * workingVLSFO) + (additionalDays * idleVLSFO);
      const lsmgoSea = extraSailing * seaLSMGO;
      const lsmgoPort = extraPortDays * portLSMGO;
      const costVLSFO = (vlsfoSea + vlsfoPort) * vlsfoCost;
      const costLSMGO = (lsmgoSea + lsmgoPort) * lsmgoCost;
      const extraCost = (totalDays * vesselHire * (1 - (addcom / 100))) + costVLSFO + costLSMGO + extraExpenses;
      const additionalFreight = quantity > 0 ? extraCost / quantity : 0;
      const newFreight = baseFreight + additionalFreight;
      const set = (id, value) => { document.getElementById(id).innerText = value.toFixed(2); };
      set("extraSailing", extraSailing);
      set("extraPortDays", extraPortDays);
      set("totalDays", totalDays);
      set("vlsfoSea", vlsfoSea);
      set("vlsfoPort", vlsfoPort);
      set("lsmgoSea", lsmgoSea);
      set("lsmgoPort", lsmgoPort);
      set("costVLSFO", costVLSFO);
      set("costLSMGO", costLSMGO);
      set("extraCost", extraCost);
      set("additionalFreight", additionalFreight);
      set("newFreight", newFreight);
    }
    document.querySelectorAll("#openbook input").forEach(input => input.addEventListener("input", calcOpenBook));
    window.addEventListener("load", calcOpenBook);
  </script>
</body>
</html>
